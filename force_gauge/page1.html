<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ForceGauge</title>
  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #ffff
      ;
      color: #333;
    }

    header {
      background: #FFC627;
      color: black;
      padding: 20px;
      text-align: center;
    }

    header h1, p {
      text-align: center;
      margin: 20px auto;
    }

    h2 {
      font-size: 1.0em;
      font-style: italic;
    }

    main {
      padding: 20px;
      text-align: center;
    }

    p {
      text-align: justify;
      padding-left: 60px;
      padding-right: 60px;
      max-width: 800px;
      margin: 0 auto;
    }

    .mermaid {
      max-width: 80%;
      margin: auto;
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    table {
      margin-left: auto;
      margin-right: auto;
      border-collapse: separate;
      border-spacing: 0;
      border: 2px solid #8c1d40;
      border-radius: 15px;
    }

    th, td {
      border: 1px solid #8c1d40;
      padding: 10px;
      text-align: center;
    }

    .justified-list-container {
      max-width: 800px;
      margin: 0 auto;
      text-align: justify;
    }

    .justified-list-container ul {
      padding-left: 20px;
    }

    .justified-list-container li,
    ul li {
      margin-bottom: 10px;
      text-align: justify;
    }

    nav {
      background: #fff;
      padding: 10px;
      text-align: center;
    }

    nav a {
      display: inline-block;
      background-color: #8c1d40;
      color: white;
      padding: 10px 20px;
      border-radius: 20px;
      text-decoration: none;
      font-family: sans-serif;
    }

    nav a:hover {
      background-color: #000;
    }

    select {
      padding: 8px;
      font-size: 1em;
      margin-bottom: 20px;
    }

    .gallery {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
    }

    .gallery img, .gallery video {
      width: 300px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      cursor: pointer;
      transition: transform 0.2s;
    }

    .gallery img:hover, .gallery video:hover {
      transform: scale(1.05);
    }

    .gallery-section {
      display: none;
    }

    .gallery-section.active {
      display: flex;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 10;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8);
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      max-width: 100%;
      max-height: 100%;
    }

    .modal-content video, .modal-content img {
      max-width: 90vw;
      max-height: 80vh;
      width: auto;
      height: auto;
      border-radius: 10px;
    }

    .close {
      position: absolute;
      top: 20px;
      right: 40px;
      font-size: 40px;
      color: white;
      cursor: pointer;
    }

    .dropdown-box {
      display: inline-block;
      background-color: #FFC627;
      padding: 15px 20px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
      margin-bottom: 20px;
    }

    .popup-image {
      display: block;
      margin: 0 auto;
      width: 800px;
      height: auto;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .popup-image:hover {
      transform: scale(1.1);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    footer {
      background: #FFC627;
      color: black;
      text-align: center;
      padding: 15px;
      margin-top: 40px;
    }
  </style>
</head>

<body>
  <header>
    <h1><b>RAS598: TEAM-04</b></h1>
    <p style="text-align: center;">STIFFNESS MEASUREMENT USING FORCE GAUGE</p>
  </header>

  <main>
      
    <h1><b>SCOPE</b></h1>
    <p>The stiffness of the ankle in the pogo stick-type model is characterized through 
      a separate controlled experiment using a force-displacement test setup. 
      This setup is designed to apply loads to the ankle joint and measure the corresponding force,
      allowing the identification of accurate force-displacement points.
    </p>
  <br>

    <div class="mermaid">
      graph TD  
        A[Project Setup] --> B[Define Experiment Parameters]  
        B --> C[ROS2-Based Software Configuration]  
        C --> D[Conduct Experiment]  
        D --> E[Data Collection]  
        E --> F[Analysis]  
        F --> G{Iterate?}  
        G -->|Yes| D  
        G -->|No| H[Report Findings - find stiffness]
    </div>

  <br>
  
    <h1><b>EXPERIMENTATION WORKFLOW</b></h1>
    
    <h2>Project Setup:</h2>
    <p>The setup contains a prototype of an ankle + leg of a quadruped, similar to a pogo stick model, with a Force Gauge ready to record data.</p>

    <h2>Define Experiment Parameters:</h2>
    <p>The model is fixed to the ground and attached via string to the hook of the force gauge. Displacement points are marked, and force readings are taken to plot and fit the stiffness curve.</p>

    <h2>ROS2-Based Software Configuration:</h2>
    <p>The force readings are handled via ROS2 and visualized in a GUI built with PyQT5. The GUI includes:</p>
    
    <div class="justified-list-container">
    <ul>
      <li>2D plot of force vs. time</li>
      <li>Buttons to start/stop recording</li>
      <li>CSV or ROS2 bag file export of data</li>
    </ul>
    </div>

    <h2>Conduct Experiment:</h2>
    <p>Tensile force is applied manually or using a UR5 arm. Force gauge records readings across varying displacement and velocity to determine stiffness and damping.</p>

    <h2>Data Collection:</h2>
    <p>A best-fit line is computed from the collected data to determine stiffness (force vs. displacement) and damping (force vs. velocity).</p>

    <p><em>Data will be collected and iterated across varying parameters.</em></p>
  
  <br>
  
    <h1><b>HARDWARE CONFIGURATION</b></h1>
    <p>The specimen is secured on the ground and connected to the Force Gauge using a string. Tensile forces are applied, and the force is recorded through multiple displacement markers. Initial testing was done manually, but to improve accuracy and repeatability, a UR5 robotic arm is now used.</p>
  
  <br>

 
    <h1><b>SOFTWARE CONFIGURATION / ROS2 ARCHITECTURE</b></h1>
    <p>The Mark-10 M4-10 force gauge communicates with the system via USB serial (baud rate: 9600).</p>

    <br>

    <nav>
      <a href="https://mark-10.com/products/force-gauges/series-4/#tab-1" target="_blank">Mark-10 Series 4 Force Gauge</a>
    </nav>
    
    <br>
    
    <div class = "justified-list-container">
    <ul>
      <li>
        <strong>Publisher node:</strong> Reads data via serial and publishes it to <code>/force_reading</code>.
      </li>
      <li>
        <strong>Subscriber node:</strong>
        <ul>
          <li>Visualizes the data in real-time</li>
          <li>GUI with buttons for recording control</li>
          <li>Automatically saves CSV and ros2bag files</li>
        </ul>
      </li>
    </ul>
  </div>
    
    <br>
    
<div style="text-align: center;">
  <img src="rosgraph.jpg" alt="ROS2 rqt_graph" class="popup-image">
  <p style="margin-top: 10px; text-align: center;">The rqt_graph of the ROS2 architecture.</p>
</div>
    
  <br>

    <h1><b>DATA COLLECTION</b></h1>
    <h2>STIFFNESS</h2>
    <p>(Check Image Gallery) shows two situations of physically pulling the Force Gauge and finding the best fit line. As seen in the results, the results are varying different counting for human error 
    and lack of data points. But the closeness of the values validate the repeatability of the setup.</p> 


  <br>

  <h1><b>CONCLUSION</b></h1>
  <p>We devised an experimental setup which will calculates the stiffness and damping. We used serial communications and ROS2 to obtain the force data and plot it and record it using a simple 
    PyQT5 GUI. We also used a UR5 to control velocities and displacements. Main problems encountered were setting up the right coordinates in the UR5. Further improvement could be possible by integrating an OptiTrack to plot displacement
    and velocity data and get a stiffness curve directly.  
  </p>

  <br>

  <h1><b>IMAGE GALLERY</b></h1>

    <div class="dropdown-box">
      <label for="mediaType">Choose media:</label>
      <select id="mediaType" onchange="switchGallery()">
        <option value="images">Images</option>
        <option value="videos">Videos</option>
      </select>

      <div id="images" class="gallery gallery-section active">
        <img src="force_setup.jpg" alt="Force Setup" onclick="openModal(this.src)">
        <img src="ur5_fg.jpg" alt="UR5 Setup" onclick="openModal(this.src)">
        <img src="bestfit.png" alt="Best Fit Graph" onclick="openModal(this.src)">
        <img src="rosgraph.jpg" alt="ROS Graph" onclick="openModal(this.src)">
      </div>

      <div id="videos" class="gallery gallery-section">
        <iframe width="400" height="400" src="https://www.youtube.com/embed/WxmLll2VZsE" frameborder="0" allowfullscreen></iframe>
        <iframe width="400" height="400" src="https://www.youtube.com/embed/wU4Gq8Kg_fg" frameborder="0" allowfullscreen></iframe>
      </div>

      <div id="popupModal" class="modal" onclick="closeModal()">
        <span class="close">&times;</span>
        <div class="modal-content" id="modalContent"></div>
      </div>
    </div>

<br>


</main>
<script>
    function switchGallery() {
      const selection = document.getElementById("mediaType").value;
      document.querySelectorAll('.gallery-section').forEach(section => {
        section.classList.remove('active');
      });
      document.getElementById(selection).classList.add('active');
    }

    function openModal(src) {
      const modal = document.getElementById("popupModal");
      const content = document.getElementById("modalContent");
      content.innerHTML = "";

      const ext = src.split('.').pop().toLowerCase();
      if (['mp4', 'webm', 'ogg'].includes(ext)) {
        const video = document.createElement("video");
        video.src = src;
        video.controls = true;
        video.autoplay = true;
        content.appendChild(video);
      } else {
        const img = document.createElement("img");
        img.src = src;
        content.appendChild(img);
      }

      modal.style.display = "flex";
    }

    function closeModal() {
      document.getElementById("popupModal").style.display = "none";
    }

    document.querySelector(".close").onclick = closeModal;
  </script>
</body>
</html>
